# Домашнее задание

## Исходная постановка

> Имеется некоторый пул транзакций для загрузки в учётную систему из внешнего источника.
> Для простоты пусть это будет таблица apps.t_import , а сама транзакция содержит только
номер, дату и сумму. Загрузка транзакций выполняется загрузчиком, который вызовет
стандартный public API учётной системы, в виде 10 параллельных сессий, вместе которые
обеспечивают загрузку данных со скоростью не менее 200 транзакций в секунду. Исходный
пул транзакций постоянно пополняется новыми данными, это могут быть дубликаты или
обновления уже имеющихся записей. Напишите проект кода загрузчика, который позволит
избежать блокировок, дубликатов и пропущенных транзакций.
> 
> Может ли одна и та же транзакция одновременно или со сдвигом по времени грузиться более
чем одним параллельным потоком?
>
> Как организовать пул таким образом, чтобы заранее не назначать (не распределять) задания
между параллельными сессиями?
>
> Какие нюансы могут возникнуть, если внешних систем, использующих общий пул, будет
несколько? Если пулов с параллельным доступом будет несколько?

## Допущения и ограничения

- Используемая база данных: Oracle 19c EE;
- Для простоты используется одна схема `importer`, в которой расположены все объекты, участвующие в загрузке, как то:
  - Таблица импорта;
  - API, которому передается транзакция;
  - Задания, имитирующие входящую нагрузку;
  - Задания, обрабатывающие таблицу t_import;
  - Процедурный код, вызываемый заданиями;
- Для простоты под действиями API будет пониматься обновление поля "Обработано" в "Истина" в таблице транзакций;
- Уникальность транзакции определяется по паре "номер - дата"
- Для простоты интерфейсный API состоит из одной функции вставки строки и при желании может быть пополнен процедурами передачи массива транзакций с последующими проверками и вставкой

## Установка

Для запуска установки требуется выполнить следующее:
``````
cd src
sqlplus privileged_user@db "@deploy.sql"
``````
Например:
``````
sqlplus sys@db as sysdba "@deploy.sql"
``````

## Установка и запуск тестов

При наличии установленного фреймворка [utPlSQL](http://utplsql.org/) можно выполнить установку и запуск тестов после установки основных компонентов:
``````
cd src
sqlplus importer@db "@tests.sql"
``````
